<!DOCTYPE html>
<html lang="uk">
<head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>Бібліотечна система</title>
            <style>
                body {
                    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                    margin: 0;
                    padding: 0;
                    background-color: #f5f5f5;
                    color: #333;
                }

                .container {
                    max-width: 1200px;
                    margin: 0 auto;
                    padding: 20px;
                }

                .navbar {
                    background-color: #2c3e50;
                    color: white;
                    padding: 10px 0;
                    margin-bottom: 20px;
                }

                .navbar-container {
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    max-width: 1200px;
                    margin: 0 auto;
                    padding: 0 20px;
                }

                .navbar-brand {
                    font-size: 24px;
                    font-weight: bold;
                    color: white;
                    text-decoration: none;
                }

                .navbar-menu {
                    display: flex;
                    list-style: none;
                }

                    .navbar-menu li {
                        margin-left: 20px;
                    }

                    .navbar-menu a {
                        color: white;
                        text-decoration: none;
                        font-weight: 500;
                        cursor: pointer;
                    }

                        .navbar-menu a:hover {
                            text-decoration: underline;
                        }

                .card {
                    background-color: white;
                    border-radius: 8px;
                    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
                    padding: 20px;
                    margin-bottom: 20px;
                }

                h1, h2, h3 {
                    color: #2c3e50;
                }

                input[type="text"], input[type="email"], input[type="password"], select {
                    width: 100%;
                    padding: 10px;
                    margin-bottom: 15px;
                    border: 1px solid #ddd;
                    border-radius: 4px;
                    box-sizing: border-box;
                }

                label {
                    display: block;
                    margin-bottom: 5px;
                    font-weight: bold;
                }

                button {
                    background-color: #3498db;
                    color: white;
                    border: none;
                    padding: 10px 15px;
                    border-radius: 4px;
                    cursor: pointer;
                    font-size: 16px;
                    margin-right: 10px;
                }

                    button:hover {
                        background-color: #2980b9;
                    }

                .red-button {
                    background-color: #e74c3c;
                }

                    .red-button:hover {
                        background-color: #c0392b;
                    }

                .green-button {
                    background-color: #2ecc71;
                }

                    .green-button:hover {
                        background-color: #27ae60;
                    }

                .checkbox-container {
                    display: flex;
                    align-items: center;
                    margin-bottom: 15px;
                }

                    .checkbox-container input {
                        margin-right: 10px;
                    }

                .form-group {
                    margin-bottom: 15px;
                }

                .tabs {
                    display: flex;
                    margin-bottom: 20px;
                    border-bottom: 1px solid #ddd;
                }

                .tab {
                    padding: 10px 20px;
                    cursor: pointer;
                    border-bottom: 2px solid transparent;
                }

                    .tab.active {
                        border-bottom: 2px solid #3498db;
                        font-weight: bold;
                    }

                .tab-content {
                    display: none;
                }

                    .tab-content.active {
                        display: block;
                    }

                .status-box {
                    padding: 15px;
                    border-radius: 4px;
                    margin-top: 20px;
                    display: none;
                }

                .success {
                    background-color: #d4edda;
                    color: #155724;
                    border: 1px solid #c3e6cb;
                }

                .error {
                    background-color: #f8d7da;
                    color: #721c24;
                    border: 1px solid #f5c6cb;
                }

                .user-info {
                    background-color: #e2f0fd;
                    padding: 15px;
                    border-radius: 4px;
                    margin-top: 20px;
                    border: 1px solid #b8daff;
                }

                .book-card {
                    border: 1px solid #ddd;
                    border-radius: 4px;
                    padding: 15px;
                    margin-bottom: 15px;
                    background-color: #fff;
                }

                .book-title {
                    font-size: 18px;
                    font-weight: bold;
                    margin-bottom: 5px;
                }

                .book-author {
                    color: #666;
                    margin-bottom: 10px;
                }

                .book-details {
                    margin-top: 10px;
                    color: #555;
                }

                .available {
                    color: #27ae60;
                    font-weight: bold;
                }

                .not-available {
                    color: #c0392b;
                    font-weight: bold;
                }

                .search-container {
                    margin-bottom: 20px;
                    display: flex;
                    gap: 10px;
                }

                    .search-container input {
                        flex-grow: 1;
                    }

                .filter-container {
                    margin-bottom: 20px;
                    display: flex;
                    gap: 10px;
                }

                    .filter-container select {
                        flex-grow: 1;
                    }

                .hidden {
                    display: none;
                }

                .user-panel {
                    display: flex;
                    align-items: center;
                    color: white;
                }

                .user-welcome {
                    margin-right: 15px;
                }

                .user-role {
                    font-size: 12px;
                    background-color: #3498db;
                    padding: 2px 6px;
                    border-radius: 10px;
                    margin-right: 10px;
                }

                .order-section {
                    margin-top: 20px;
                }

                .order-card {
                    border: 1px solid #ddd;
                    border-radius: 4px;
                    padding: 15px;
                    margin-bottom: 15px;
                    background-color: #fff;
                }

                .order-details {
                    margin-top: 10px;
                }

                .order-status {
                    font-weight: bold;
                    margin-top: 5px;
                }

                .admin-section {
                    margin-top: 20px;
                }

                    .admin-section h3 {
                        margin-bottom: 15px;
                    }

                .form-row {
                    display: flex;
                    gap: 15px;
                    margin-bottom: 15px;
                }

                    .form-row .form-group {
                        flex: 1;
                    }

                .pagination {
                    display: flex;
                    list-style: none;
                    padding: 0;
                    margin: 20px 0;
                    justify-content: center;
                }

                    .pagination li {
                        margin: 0 5px;
                    }

                    .pagination button {
                        padding: 5px 10px;
                        background-color: #f5f5f5;
                        color: #333;
                        border: 1px solid #ddd;
                        cursor: pointer;
                    }

                        .pagination button.active {
                            background-color: #3498db;
                            color: white;
                            border: 1px solid #3498db;
                        }
</style>
    </head>
    <body>
            <div class="navbar">
                <div class="navbar-container">
                    <a href="#" class="navbar-brand">Бібліотечна система</a>
                    <ul class="navbar-menu" id="mainMenu">
                        <li><a href="#" data-tab="books">Книги</a></li>
                        <li class="auth-required hidden"><a href="#" data-tab="myOrders">Мої замовлення</a></li>
                        <li class="admin-required hidden"><a href="#" data-tab="admin">Адміністрування</a></li>
                        <li class="guest-only"><a href="#" data-tab="auth">Вхід/Реєстрація</a></li>
                        <li class="auth-required hidden"><a href="#" id="logoutBtn">Вихід</a></li>
                    </ul>
                    <div class="user-panel hidden" id="userPanel">
                        <div class="user-welcome">Вітаємо, <span id="userName">користувач</span>!</div>
                        <div id="userRoles"></div>
                    </div>
                </div>
            </div>

            <div class="container">
                <!-- Головний контент -->
                <div class="tab-content" id="booksTab">
                    <h1>Каталог книг</h1>

                    <div class="search-container">
                        <input type="text" id="searchBook" placeholder="Пошук книг...">
                        <button id="searchButton">Пошук</button>
                        <button id="resetSearch">Скинути</button>
                    </div>

                    <div class="filter-container">
                        <select id="genreFilter">
                            <option value="">Всі жанри</option>
                            <option value="0">Фантастика</option>
                            <option value="1">Детектив</option>
                            <option value="2">Роман</option>
                            <option value="3">Наукова література</option>
                            <option value="4">Історія</option>
                        </select>

                        <select id="typeFilter">
                            <option value="">Всі типи</option>
                            <option value="0">Паперова книга</option>
                            <option value="1">Електронна книга</option>
                            <option value="2">Аудіокнига</option>
                        </select>

                        <select id="sortOrder">
                            <option value="">Без сортування</option>
                            <option value="author">За автором</option>
                            <option value="year">За роком</option>
                            <option value="availability">За доступністю</option>
                        </select>

                        <button id="applyFilters">Застосувати фільтри</button>
                    </div>

                    <div id="booksList"></div>

                    <div class="pagination" id="booksPagination"></div>
                </div>

                <!-- Вкладка авторизації -->
                <div class="tab-content" id="authTab">
                    <div class="card">
                        <div class="tabs">
                            <div class="tab active" data-tab="login">Вхід</div>
                            <div class="tab" data-tab="register">Реєстрація</div>
                        </div>

                        <!-- Форма входу -->
                        <div id="loginTab" class="tab-content active">
                            <h2>Вхід в систему</h2>
                            <form id="loginForm">
                                <div class="form-group">
                                    <label for="loginEmail">Email:</label>
                                    <input type="email" id="loginEmail" required placeholder="example@email.com">
                                </div>

                                <div class="form-group">
                                    <label for="loginPassword">Пароль:</label>
                                    <input type="password" id="loginPassword" required>
                                </div>

                                <div class="checkbox-container">
                                    <input type="checkbox" id="rememberMe">
                                    <label for="rememberMe">Запам'ятати мене</label>
                                </div>

                                <button type="submit">Увійти</button>
                            </form>
                            <div id="loginStatus" class="status-box"></div>
                        </div>

                        <!-- Форма реєстрації -->
                        <div id="registerTab" class="tab-content">
                            <h2>Реєстрація нового користувача</h2>
                            <form id="registerForm">
                                <div class="form-group">
                                    <label for="registerEmail">Email:</label>
                                    <input type="email" id="registerEmail" required placeholder="example@email.com">
                                </div>

                                <div class="form-group">
                                    <label for="firstName">Ім'я:</label>
                                    <input type="text" id="firstName" required>
                                </div>

                                <div class="form-group">
                                    <label for="lastName">Прізвище:</label>
                                    <input type="text" id="lastName" required>
                                </div>

                                <div class="form-group">
                                    <label for="registerPassword">Пароль:</label>
                                    <input type="password" id="registerPassword" required>
                                </div>

                                <div class="form-group">
                                    <label for="confirmPassword">Підтвердження паролю:</label>
                                    <input type="password" id="confirmPassword" required>
                                </div>

                                <button type="submit">Зареєструватися</button>
                            </form>
                            <div id="registerStatus" class="status-box"></div>
                        </div>
                    </div>
                </div>

                <!-- Вкладка замовлень користувача -->
                <div class="tab-content" id="myOrdersTab">
                    <h1>Мої замовлення</h1>
                    <div id="userOrdersList"></div>
                    <div id="orderStatus" class="status-box"></div>

                    <div class="order-section">
                        <h2>Нове замовлення</h2>
                        <form id="createOrderForm">
                            <div class="form-group">
                                <label for="orderBookId">Обрати книгу:</label>
                                <select id="orderBookId" required></select>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="startDate">Дата початку:</label>
                                    <input type="date" id="startDate" required>
                                </div>

                                <div class="form-group">
                                    <label for="endDate">Дата завершення:</label>
                                    <input type="date" id="endDate" required>
                                </div>
                            </div>

                            <button type="submit" class="green-button">Створити замовлення</button>
                        </form>
                        <div id="createOrderStatus" class="status-box"></div>
                    </div>
                </div>

                <!-- Вкладка адміністрування -->
                <div class="tab-content" id="adminTab">
                    <h1>Панель адміністрування</h1>

                    <div class="tabs">
                        <div class="tab active" data-admin-tab="books">Керування книгами</div>
                        <div class="tab" data-admin-tab="orders">Керування замовленнями</div>
                        <div class="tab" data-admin-tab="users">Керування користувачами</div>
                    </div>

                    <!-- Керування книгами -->
                    <div class="admin-tab-content active" id="adminBooksTab">
                        <div class="admin-section">
                            <h2>Додати нову книгу</h2>
                            <form id="addBookForm">
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="bookTitle">Назва:</label>
                                        <input type="text" id="bookTitle" required>
                                    </div>

                                    <div class="form-group">
                                        <label for="bookAuthor">Автор:</label>
                                        <input type="text" id="bookAuthor" required>
                                    </div>
                                </div>

                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="bookYear">Рік видання:</label>
                                        <input type="number" id="bookYear" required min="1800" max="2025">
                                    </div>

                                    <div class="form-group">
                                        <label for="bookGenre">Жанр:</label>
                                        <select id="bookGenre" required>
                                            <option value="0">Фантастика</option>
                                            <option value="1">Детектив</option>
                                            <option value="2">Роман</option>
                                            <option value="3">Наукова література</option>
                                            <option value="4">Історія</option>
                                        </select>
                                    </div>

                                    <div class="form-group">
                                        <label for="bookType">Тип:</label>
                                        <select id="bookType" required>
                                            <option value="0">Паперова книга</option>
                                            <option value="1">Електронна книга</option>
                                            <option value="2">Аудіокнига</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label for="bookDescription">Опис:</label>
                                    <input type="text" id="bookDescription" required>
                                </div>

                                <button type="submit" class="green-button">Додати книгу</button>
                            </form>
                            <div id="addBookStatus" class="status-box"></div>
                        </div>

                        <div class="admin-section">
                            <h2>Список книг</h2>
                            <div id="adminBooksList"></div>
                        </div>
                    </div>

                    <!-- Керування замовленнями -->
                    <div class="admin-tab-content" id="adminOrdersTab">
                        <h2>Всі замовлення</h2>
                        <div id="adminOrdersList"></div>
                        <div id="adminOrderStatus" class="status-box"></div>
                    </div>

                    <!-- Керування користувачами -->
                    <div class="admin-tab-content" id="adminUsersTab">
                        <h2>Список користувачів</h2>
                        <div id="adminUsersList"></div>
                        <div id="adminUsersStatus" class="status-box"></div>
                    </div>
                </div>
            </div>

            <script>
                // Базовий URL API
                const apiBaseUrl = '/api';

                // Глобальні змінні
                let currentUser = null;
                let allBooks = [];
                let userOrders = [];
                let allOrders = [];
                let allUsers = [];
                let currentPage = 1;
                const itemsPerPage = 5;

                // Допоміжні функції
                function showStatusMessage(elementId, message, isSuccess) {
                    const statusBox = document.getElementById(elementId);
                    statusBox.textContent = message;
                    statusBox.className = isSuccess ? 'status-box success' : 'status-box error';
                    statusBox.style.display = 'block';

                    // Автоматично приховати повідомлення через 5 секунд
                    setTimeout(() => {
                        statusBox.style.display = 'none';
                    }, 5000);
                }

                function formatDate(dateString) {
                    if (!dateString) return '';
                    const date = new Date(dateString);
                    return date.toLocaleDateString('uk-UA');
                }

                // Переключення основних вкладок
                document.querySelectorAll('#mainMenu a[data-tab]').forEach(tab => {
                    tab.addEventListener('click', (e) => {
                        e.preventDefault();
                        const tabId = tab.getAttribute('data-tab');

                        // Приховуємо всі вкладки
                        document.querySelectorAll('.tab-content').forEach(content => {
                            content.style.display = 'none';
                        });

                        // Показуємо вибрану вкладку
                        document.getElementById(`${tabId}Tab`).style.display = 'block';

                        // Якщо це вкладка "Книги", викликаємо завантаження книг
                        if (tabId === 'books') {
                            loadBooks();
                        }

                        // Якщо це вкладка "Мої замовлення", викликаємо завантаження замовлень
                        if (tabId === 'myOrders') {
                            loadUserOrders();
                            loadAvailableBooksForOrder();
                        }

                        // Якщо це вкладка "Адміністрування", завантажуємо необхідні дані
                        if (tabId === 'admin') {
                            loadAdminData();
                        }
                    });
                });

                // Переключення вкладок в панелі адміністрування
                document.querySelectorAll('[data-admin-tab]').forEach(tab => {
                    tab.addEventListener('click', () => {
                        // Видалення класу active у всіх вкладок
                        document.querySelectorAll('[data-admin-tab]').forEach(t => t.classList.remove('active'));
                        // Приховування всіх вкладок
                        document.querySelectorAll('.admin-tab-content').forEach(c => c.style.display = 'none');

                        // Додавання класу active до натиснутої вкладки
                        tab.classList.add('active');
                        // Відображення відповідного контенту
                        const tabId = tab.getAttribute('data-admin-tab');
                        document.getElementById(`admin${tabId.charAt(0).toUpperCase() + tabId.slice(1)}Tab`).style.display = 'block';
                    });
                });

                // Переключення вкладок в формі авторизації
                document.querySelectorAll('.tab[data-tab]').forEach(tab => {
                    tab.addEventListener('click', () => {
                        // Видалення класу active у всіх вкладок
                        document.querySelectorAll('.tab[data-tab]').forEach(t => t.classList.remove('active'));
                        // Приховування всіх вкладок
                        document.querySelectorAll('#loginTab, #registerTab').forEach(c => c.classList.remove('active'));

                        // Додавання класу active до натиснутої вкладки
                        tab.classList.add('active');
                        // Відображення відповідного контенту
                        const tabId = tab.getAttribute('data-tab');
                        document.getElementById(`${tabId}Tab`).classList.add('active');
                    });
                });

                // Перевірка статусу автентифікації при завантаженні сторінки
                async function checkAuthStatus() {
                    try {
                        const response = await fetch(`${apiBaseUrl}/account/status`, {
                            method: 'GET',
                            credentials: 'include'
                        });

                        const result = await response.json();

                        if (result.isAuthenticated) {
                            currentUser = result.user;
                            updateUIAfterLogin();

                            // Відображаємо вкладку "Книги" по замовчуванню
                            document.querySelectorAll('.tab-content').forEach(content => {
                                content.style.display = 'none';
                            });
                            document.getElementById('booksTab').style.display = 'block';

                            // Завантажуємо список книг
                            loadBooks();
                        } else {
                            // Відображаємо вкладку "Книги" по замовчуванню
                            document.querySelectorAll('.tab-content').forEach(content => {
                                content.style.display = 'none';
                            });
                            document.getElementById('booksTab').style.display = 'block';

                            // Завантажуємо список книг
                            loadBooks();
                        }
                    } catch (error) {
                        console.error('Помилка перевірки статусу автентифікації:', error);

                        // У випадку помилки, відображаємо вкладку "Книги"
                        document.querySelectorAll('.tab-content').forEach(content => {
                            content.style.display = 'none';
                        });
                        document.getElementById('booksTab').style.display = 'block';

                        // Завантажуємо список книг
                        loadBooks();
                    }
                }

                // Оновлення інтерфейсу після входу в систему
                function updateUIAfterLogin() {
                    // Показуємо/приховуємо елементи навігації в залежності від статусу автентифікації
                    document.querySelectorAll('.auth-required').forEach(el => el.classList.remove('hidden'));
                    document.querySelectorAll('.guest-only').forEach(el => el.classList.add('hidden'));

                    // Відображаємо інформацію про користувача
                    document.getElementById('userPanel').classList.remove('hidden');
                    document.getElementById('userName').textContent = `${currentUser.firstName} ${currentUser.lastName}`;

                    // Відображаємо ролі користувача
                    const rolesContainer = document.getElementById('userRoles');
                    rolesContainer.innerHTML = '';

                    if (currentUser.roles && currentUser.roles.length > 0) {
                        currentUser.roles.forEach(role => {
                            const roleSpan = document.createElement('span');
                            roleSpan.className = 'user-role';
                            roleSpan.textContent = role;
                            rolesContainer.appendChild(roleSpan);
                        });

                        // Показуємо вкладку "Адміністрування" для адміністраторів та менеджерів
                        if (currentUser.roles.includes('Administrator') || currentUser.roles.includes('Manager')) {
                            document.querySelectorAll('.admin-required').forEach(el => el.classList.remove('hidden'));
                        } else {
                            document.querySelectorAll('.admin-required').forEach(el => el.classList.add('hidden'));
                        }
                    }
                }
                        // Обробка форми входу
                document.getElementById('loginForm').addEventListener('submit', async (e) => {
                    e.preventDefault();

                    const loginData = {
                        Email: document.getElementById('loginEmail').value,
                        Password: document.getElementById('loginPassword').value,
                        RememberMe: document.getElementById('rememberMe').checked,
                        ReturnUrl: "/"
                    };

                    try {
                        const response = await fetch(`${apiBaseUrl}/account/login`, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify(loginData),
                            credentials: 'include'
                        });

                        if (response.ok) {
                            const result = await response.json();
                            showStatusMessage('loginStatus', 'Вхід виконано успішно', true);

                            // Зберігаємо інформацію про користувача
                            currentUser = result.user;

                            // Оновлюємо інтерфейс
                            updateUIAfterLogin();

                            // Очищаємо форму
                            document.getElementById('loginForm').reset();

                            // Переходимо на вкладку "Книги"
                            document.querySelectorAll('.tab-content').forEach(content => {
                                content.style.display = 'none';
                            });
                            document.getElementById('booksTab').style.display = 'block';

                            // Завантажуємо список книг
                            loadBooks();
                        } else {
                            const result = await response.json();
                            showStatusMessage('loginStatus', result.message || 'Помилка входу', false);
                        }
                    } catch (error) {
                        showStatusMessage('loginStatus', `Помилка: ${error.message}`, false);
                    }
                });

                // Обробка форми реєстрації
                document.getElementById('registerForm').addEventListener('submit', async (e) => {
                    e.preventDefault();

                    const password = document.getElementById('registerPassword').value;
                    const confirmPassword = document.getElementById('confirmPassword').value;

                    if (password !== confirmPassword) {
                        showStatusMessage('registerStatus', 'Паролі не співпадають', false);
                        return;
                    }

                    const registerData = {
                        email: document.getElementById('registerEmail').value,
                        firstName: document.getElementById('firstName').value,
                        lastName: document.getElementById('lastName').value,
                        password: password,
                        confirmPassword: confirmPassword
                    };

                    try {
                        const response = await fetch(`${apiBaseUrl}/account/register`, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify(registerData),
                            credentials: 'include'
                        });

                        if (response.ok) {
                            const result = await response.json();
                            showStatusMessage('registerStatus', 'Реєстрація пройшла успішно', true);

                            // Зберігаємо інформацію про користувача
                            currentUser = result.user;

                            // Оновлюємо інтерфейс
                            updateUIAfterLogin();

                            // Очищаємо форму
                            document.getElementById('registerForm').reset();

                            // Переходимо на вкладку "Книги"
                            document.querySelectorAll('.tab-content').forEach(content => {
                                content.style.display = 'none';
                            });
                            document.getElementById('booksTab').style.display = 'block';

                            // Завантажуємо список книг
                            loadBooks();
                        } else {
                            const result = await response.json();
                            let errorMessage = 'Помилка реєстрації';

                            if (result.message) {
                                errorMessage = result.message;
                            } else if (result.errors) {
                                errorMessage = Array.isArray(result.errors)
                                    ? result.errors.join(', ')
                                    : Object.values(result.errors).join(', ');
                            }

                            showStatusMessage('registerStatus', errorMessage, false);
                        }
                    } catch (error) {
                        showStatusMessage('registerStatus', `Помилка: ${error.message}`, false);
                    }
                });

                // Обробка виходу з системи
                document.getElementById('logoutBtn').addEventListener('click', async (e) => {
                    e.preventDefault();

                    try {
                        const response = await fetch(`${apiBaseUrl}/account/logout`, {
                            method: 'POST',
                            credentials: 'include'
                        });

                        if (response.ok) {
                            // Скидаємо інформацію про користувача
                            currentUser = null;

                            // Оновлюємо інтерфейс
                            document.querySelectorAll('.auth-required').forEach(el => el.classList.add('hidden'));
                            document.querySelectorAll('.guest-only').forEach(el => el.classList.remove('hidden'));
                            document.querySelectorAll('.admin-required').forEach(el => el.classList.add('hidden'));
                            document.getElementById('userPanel').classList.add('hidden');

                            // Переходимо на вкладку "Книги"
                            document.querySelectorAll('.tab-content').forEach(content => {
                                content.style.display = 'none';
                            });
                            document.getElementById('booksTab').style.display = 'block';

                            // Завантажуємо список книг
                            loadBooks();
                        } else {
                            console.error('Помилка виходу з системи');
                        }
                    } catch (error) {
                        console.error('Помилка виходу з системи:', error);
                    }
                });

                // Завантаження списку книг
                async function loadBooks(filters = {}) {
                    try {
                        let url = `${apiBaseUrl}/books/filter?`;

                        // Додаємо параметри фільтрації, якщо вони є
                        if (filters.searchString) {
                            url += `searchString=${encodeURIComponent(filters.searchString)}&`;
                        }

                        if (filters.genre) {
                            url += `genre=${filters.genre}&`;
                        }

                        if (filters.type) {
                            url += `type=${filters.type}&`;
                        }

                        if (filters.sortOrder) {
                            url += `sortOrder=${filters.sortOrder}&`;
                        }

                        const response = await fetch(url, {
                            method: 'GET',
                            credentials: 'include'
                        });

                        if (response.ok) {
                            const books = await response.json();
                            allBooks = books;
                            displayBooks(books, currentPage);
                            displayPagination(books.length, currentPage);
                        } else {
                            console.error('Помилка завантаження книг');
                        }
                    } catch (error) {
                        console.error('Помилка завантаження книг:', error);
                    }
                }

                // Відображення книг з пагінацією
                function displayBooks(books, page) {
                    const booksListContainer = document.getElementById('booksList');
                    booksListContainer.innerHTML = '';

                    if (books.length === 0) {
                        booksListContainer.innerHTML = '<p>Книги не знайдені</p>';
                        return;
                    }

                    // Розрахунок пагінації
                    const startIndex = (page - 1) * itemsPerPage;
                    const endIndex = Math.min(startIndex + itemsPerPage, books.length);
                    const booksToDisplay = books.slice(startIndex, endIndex);

                    booksToDisplay.forEach(book => {
                        const bookCard = document.createElement('div');
                        bookCard.className = 'book-card';

                        const availabilityClass = book.isAvailable ? 'available' : 'not-available';
                        const availabilityText = book.isAvailable ? 'Доступна' : 'Недоступна';

                        // Визначення типу книги
                        let bookType = '';
                        switch (book.type) {
                            case 0: bookType = 'Паперова книга'; break;
                            case 1: bookType = 'Електронна книга'; break;
                            case 2: bookType = 'Аудіокнига'; break;
                            default: bookType = 'Невідомий тип';
                        }

                        // Визначення жанру книги
                        let bookGenre = '';
                        switch (book.genre) {
                            case 0: bookGenre = 'Фантастика'; break;
                            case 1: bookGenre = 'Детектив'; break;
                            case 2: bookGenre = 'Роман'; break;
                            case 3: bookGenre = 'Наукова література'; break;
                            case 4: bookGenre = 'Історія'; break;
                            default: bookGenre = 'Невідомий жанр';
                        }

                        bookCard.innerHTML = `
<div class="book-title">${book.title}</div>
<div class="book-author">Автор: ${book.author}</div>
<div class="book-details">
            <p>Рік видання: ${book.yearOfPublication}</p>
            <p>Жанр: ${bookGenre}</p>
            <p>Тип: ${bookType}</p>
            <p>Статус: <span class="${availabilityClass}">${availabilityText}</span></p>
            <p>Опис: ${book.description || 'Опис відсутній'}</p>
</div>
                        `;

                        // Додаємо кнопку "Замовити" для авторизованих користувачів
                        if (currentUser && book.isAvailable) {
                            const orderButton = document.createElement('button');
                            orderButton.textContent = 'Замовити';
                            orderButton.className = 'green-button';
                            orderButton.addEventListener('click', () => {
                                // Переходимо на вкладку "Мої замовлення"
                                document.querySelectorAll('.tab-content').forEach(content => {
                                    content.style.display = 'none';
                                });
                                document.getElementById('myOrdersTab').style.display = 'block';

                                // Вибираємо книгу в формі замовлення
                                const orderBookSelect = document.getElementById('orderBookId');
                                orderBookSelect.value = book.id;

                                // Фокусуємось на даті початку
                                document.getElementById('startDate').focus();
                            });

                            bookCard.appendChild(orderButton);
                        }

                        booksListContainer.appendChild(bookCard);
                    });
                }

                // Відображення пагінації
                function displayPagination(totalItems, currentPageNum) {
                    const totalPages = Math.ceil(totalItems / itemsPerPage);
                    const paginationContainer = document.getElementById('booksPagination');
                    paginationContainer.innerHTML = '';

                    if (totalPages <= 1) {
                        return;
                    }

                    const ul = document.createElement('ul');
                    ul.className = 'pagination';

                    // Кнопка "Попередня"
                    if (currentPageNum > 1) {
                        const prevLi = document.createElement('li');
                        const prevButton = document.createElement('button');
                        prevButton.textContent = '←';
                        prevButton.addEventListener('click', () => {
                            currentPage = currentPageNum - 1;
                            displayBooks(allBooks, currentPage);
                            displayPagination(totalItems, currentPage);
                        });
                        prevLi.appendChild(prevButton);
                        ul.appendChild(prevLi);
                    }

                    // Нумеровані сторінки
                    for (let i = 1; i <= totalPages; i++) {
                        const li = document.createElement('li');
                        const button = document.createElement('button');
                        button.textContent = i;

                        if (i === currentPageNum) {
                            button.className = 'active';
                        }

                        button.addEventListener('click', () => {
                            currentPage = i;
                            displayBooks(allBooks, currentPage);
                            displayPagination(totalItems, currentPage);
                        });

                        li.appendChild(button);
                        ul.appendChild(li);
                    }

                    // Кнопка "Наступна"
                    if (currentPageNum < totalPages) {
                        const nextLi = document.createElement('li');
                        const nextButton = document.createElement('button');
                        nextButton.textContent = '→';
                        nextButton.addEventListener('click', () => {
                            currentPage = currentPageNum + 1;
                            displayBooks(allBooks, currentPage);
                            displayPagination(totalItems, currentPage);
                        });
                        nextLi.appendChild(nextButton);
                        ul.appendChild(nextLi);
                    }

                    paginationContainer.appendChild(ul);
                }

                // Пошук книг
                document.getElementById('searchButton').addEventListener('click', () => {
                    const searchString = document.getElementById('searchBook').value;
                    currentPage = 1;
                    loadBooks({ searchString });
                });

                // Скидання пошуку
                document.getElementById('resetSearch').addEventListener('click', () => {
                    document.getElementById('searchBook').value = '';
                    document.getElementById('genreFilter').value = '';
                    document.getElementById('typeFilter').value = '';
                    document.getElementById('sortOrder').value = '';
                    currentPage = 1;
                    loadBooks();
                });

                // Застосування фільтрів
                document.getElementById('applyFilters').addEventListener('click', () => {
                    const searchString = document.getElementById('searchBook').value;
                    const genre = document.getElementById('genreFilter').value;
                    const type = document.getElementById('typeFilter').value;
                    const sortOrder = document.getElementById('sortOrder').value;
                    currentPage = 1;
                    loadBooks({ searchString, genre, type, sortOrder });
                });

                // Завантаження замовлень користувача
                async function loadUserOrders() {
                    if (!currentUser) return;

                    try {
                        const response = await fetch(`${apiBaseUrl}/books/GetUserOrders`, {
                            method: 'GET',
                            credentials: 'include'
                        });

                        if (response.ok) {
                            const books = await response.json();
                            userOrders = books;
                            displayUserOrders(books);
                        } else {
                            console.error('Помилка завантаження замовлень');
                        }
                    } catch (error) {
                        console.error('Помилка завантаження замовлень:', error);
                    }
                }

                // Відображення замовлень користувача
                function displayUserOrders(books) {
                    const ordersContainer = document.getElementById('userOrdersList');
                    ordersContainer.innerHTML = '';

                    if (books.length === 0) {
                        ordersContainer.innerHTML = '<p>У вас немає активних замовлень</p>';
                        return;
                    }

                    books.forEach(book => {
                        const orderCard = document.createElement('div');
                        orderCard.className = 'order-card';

                        orderCard.innerHTML = `
<div class="book-title">${book.title}</div>
<div class="book-author">Автор: ${book.author}</div>
<div class="order-details">
            <p>Рік видання: ${book.yearOfPublication}</p>
            <p>Жанр: ${getGenreName(book.genre)}</p>
            <p>Тип: ${getTypeName(book.type)}</p>
</div>
                        `;

                        ordersContainer.appendChild(orderCard);
                    });
                }

                // Завантаження доступних книг для створення замовлення
                async function loadAvailableBooksForOrder() {
                    try {
                        const response = await fetch(`${apiBaseUrl}/books/filter`, {
                            method: 'GET',
                            credentials: 'include'
                        });

                        if (response.ok) {
                            const books = await response.json();
                            const availableBooks = books.filter(book => book.isAvailable);

                            const orderBookSelect = document.getElementById('orderBookId');
                            orderBookSelect.innerHTML = '';

                            // Додаємо порожню опцію
                            const emptyOption = document.createElement('option');
                            emptyOption.value = '';
                            emptyOption.textContent = 'Оберіть книгу';
                            orderBookSelect.appendChild(emptyOption);

                            // Додаємо опції для кожної доступної книги
                            availableBooks.forEach(book => {
                                const option = document.createElement('option');
                                option.value = book.id;
                                option.textContent = `${book.title} (${book.author})`;
                                orderBookSelect.appendChild(option);
                            });
                        } else {
                            console.error('Помилка завантаження доступних книг');
                        }
                    } catch (error) {
                        console.error('Помилка завантаження доступних книг:', error);
                    }
                }

                // Створення нового замовлення
                document.getElementById('createOrderForm').addEventListener('submit', async (e) => {
                    e.preventDefault();

                    const bookId = document.getElementById('orderBookId').value;
                    const startDate = document.getElementById('startDate').value;
                    const endDate = document.getElementById('endDate').value;

                    if (!bookId || !startDate || !endDate) {
                        showStatusMessage('createOrderStatus', 'Заповніть всі поля форми', false);
                        return;
                    }

                    // Перевіряємо, чи дата закінчення пізніше дати початку
                    if (new Date(endDate) <= new Date(startDate)) {
                        showStatusMessage('createOrderStatus', 'Дата закінчення повинна бути пізніше дати початку', false);
                        return;
                    }

                    const orderData = {
                        BookId: parseInt(bookId),
                        UserId: currentUser.id, // UserId буде взято з автентифікованого користувача на сервері
                        StartDate: startDate,
                        EndDate: endDate,
                        Status: 0 // 0 - нове замовлення
                    };

                    try {
                        const response = await fetch('/orders/CreateNewOrder', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify(orderData),
                            credentials: 'include'
                        });

                        if (response.ok) {
                            showStatusMessage('createOrderStatus', 'Замовлення успішно створено', true);
                            document.getElementById('createOrderForm').reset();

                            // Перезавантажуємо список замовлень
                            loadUserOrders();
                        } else {
                            let errorMessage = 'Помилка створення замовлення';
                            try {
                                const errorData = await response.json();
                                errorMessage = errorData.message || errorMessage;
                            } catch (e) {
                                // Ігноруємо помилку парсингу JSON
                            }
                            showStatusMessage('createOrderStatus', errorMessage, false);
                        }
                    } catch (error) {
                        showStatusMessage('createOrderStatus', `Помилка: ${error.message}`, false);
                    }
                });

                // Завантаження даних для панелі адміністрування
                async function loadAdminData() {
                    if (!currentUser || !(currentUser.roles.includes('Administrator') || currentUser.roles.includes('Manager'))) {
                        return;
                    }

                    // Завантажуємо список книг для адміністратора
                    loadAdminBooks();

                    // Якщо користувач має роль "Administrator", завантажуємо замовлення та користувачів
                    if (currentUser.roles.includes('Administrator') || currentUser.roles.includes('Manager')) {
                        loadAllOrders();

                        if (currentUser.roles.includes('Administrator')) {
                            // Завантажуємо користувачів тільки для адміністратора
                            // loadAllUsers(); // Цей метод необхідно буде реалізувати при необхідності
                        }
                    }
                }

                // Завантаження книг для панелі адміністрування
                async function loadAdminBooks() {
                    try {
                        const response = await fetch(`${apiBaseUrl}/books/GetAll`, {
                            method: 'GET',
                            credentials: 'include'
                        });

                        if (response.ok) {
                            const books = await response.json();
                            displayAdminBooks(books);
                        } else {
                            console.error('Помилка завантаження книг для адміністратора');
                        }
                    } catch (error) {
                        console.error('Помилка завантаження книг для адміністратора:', error);
                    }
                }

                // Відображення книг у панелі адміністрування
                function displayAdminBooks(books) {
                    const adminBooksContainer = document.getElementById('adminBooksList');
                    adminBooksContainer.innerHTML = '';

                    if (books.length === 0) {
                        adminBooksContainer.innerHTML = '<p>Книги не знайдені</p>';
                        return;
                    }

                    books.forEach(book => {
                        const bookCard = document.createElement('div');
                        bookCard.className = 'book-card';

                        const availabilityClass = book.isAvailable ? 'available' : 'not-available';
                        const availabilityText = book.isAvailable ? 'Доступна' : 'Недоступна';

                        bookCard.innerHTML = `
<div class="book-title">${book.title}</div>
<div class="book-author">Автор: ${book.author}</div>
<div class="book-details">
            <p>Рік видання: ${book.yearOfPublication}</p>
            <p>Жанр: ${getGenreName(book.genre)}</p>
            <p>Тип: ${getTypeName(book.type)}</p>
            <p>Статус: <span class="${availabilityClass}">${availabilityText}</span></p>
            <p>Опис: ${book.description || 'Опис відсутній'}</p>
</div>
                        `;

                        // Додаємо кнопки для керування книгою (тільки для адміністратора та менеджера)
                        if (currentUser && (currentUser.roles.includes('Administrator') || currentUser.roles.includes('Manager'))) {
                            const buttonContainer = document.createElement('div');
                            buttonContainer.style.marginTop = '10px';

                            // Кнопка "Змінити доступність"
                            const toggleAvailabilityButton = document.createElement('button');
                            toggleAvailabilityButton.textContent = book.isAvailable ? 'Зробити недоступною' : 'Зробити доступною';
                            toggleAvailabilityButton.className = book.isAvailable ? 'red-button' : 'green-button';
                            toggleAvailabilityButton.addEventListener('click', () => {
                                toggleBookAvailability(book.id, !book.isAvailable);
                            });
                            buttonContainer.appendChild(toggleAvailabilityButton);

                            // Кнопка "Видалити" (тільки для адміністратора)
                            if (currentUser.roles.includes('Administrator')) {
                                const deleteButton = document.createElement('button');
                                deleteButton.textContent = 'Видалити';
                                deleteButton.className = 'red-button';
                                deleteButton.style.marginLeft = '10px';
                                deleteButton.addEventListener('click', () => {
                                    if (confirm(`Ви впевнені, що хочете видалити книгу "${book.title}"?`)) {
                                        deleteBook(book.id);
                                    }
                                });
                                buttonContainer.appendChild(deleteButton);
                            }

                            bookCard.appendChild(buttonContainer);
                        }

                        adminBooksContainer.appendChild(bookCard);
                    });
                }

                // Зміна доступності книги
                async function toggleBookAvailability(bookId, isAvailable) {
                    try {
                        const response = await fetch(`${apiBaseUrl}/books/SetAvailability/${bookId}`, {
                            method: 'PUT',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify(isAvailable),
                            credentials: 'include'
                        });

                        if (response.ok) {
                            showStatusMessage('addBookStatus', `Доступність книги успішно змінена`, true);

                            // Перезавантажуємо списки книг
                            loadAdminBooks();
                            loadBooks();
                        } else {
                            let errorMessage = 'Помилка зміни доступності книги';
                            try {
                                const errorData = await response.json();
                                errorMessage = errorData.message || errorMessage;
                            } catch (e) {
                                // Ігноруємо помилку парсингу JSON
                            }
                            showStatusMessage('addBookStatus', errorMessage, false);
                        }
                    } catch (error) {
                        showStatusMessage('addBookStatus', `Помилка: ${error.message}`, false);
                    }
                }

                // Видалення книги
                async function deleteBook(bookId) {
                    try {
                        const response = await fetch(`${apiBaseUrl}/books/Delete/${bookId}`, {
                            method: 'DELETE',
                            credentials: 'include'
                        });

                        if (response.ok) {
                            showStatusMessage('addBookStatus', `Книга успішно видалена`, true);

                            // Перезавантажуємо списки книг
                            loadAdminBooks();
                            loadBooks();
                        } else {
                            let errorMessage = 'Помилка видалення книги';
                            try {
                                const errorData = await response.json();
                                errorMessage = errorData.message || errorMessage;
                            } catch (e) {
                                // Ігноруємо помилку парсингу JSON
                            }
                            showStatusMessage('addBookStatus', errorMessage, false);
                        }
                    } catch (error) {
                        showStatusMessage('addBookStatus', `Помилка: ${error.message}`, false);
                    }
                }

                // Додавання нової книги
                document.getElementById('addBookForm').addEventListener('submit', async (e) => {
                    e.preventDefault();

                    const bookData = {
                        title: document.getElementById('bookTitle').value,
                        author: document.getElementById('bookAuthor').value,
                        yearOfPublication: parseInt(document.getElementById('bookYear').value),
                        genre: parseInt(document.getElementById('bookGenre').value),
                        type: parseInt(document.getElementById('bookType').value),
                        description: document.getElementById('bookDescription').value,
                        isAvailable: true
                    };

                    try {
                        const response = await fetch(`${apiBaseUrl}/books/Create`, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify(bookData),
                            credentials: 'include'
                        });

                        if (response.ok) {
                            showStatusMessage('addBookStatus', 'Книга успішно додана', true);
                            document.getElementById('addBookForm').reset();

                            // Перезавантажуємо списки книг
                            loadAdminBooks();
                            loadBooks();
                        } else {
                            let errorMessage = 'Помилка додавання книги';
                            try {
                                const errorData = await response.json();
                                errorMessage = errorData.message || errorMessage;
                            } catch (e) {
                                // Ігноруємо помилку парсингу JSON
                            }
                            showStatusMessage('addBookStatus', errorMessage, false);
                        }
                    } catch (error) {
                        showStatusMessage('addBookStatus', `Помилка: ${error.message}`, false);
                    }
                });

                // Завантаження всіх замовлень (для адміністратора та менеджера)
                async function loadAllOrders() {
                    try {
                        const response = await fetch('/orders/Getall', {
                            method: 'GET',
                            credentials: 'include'
                        });

                        if (response.ok) {
                            const orders = await response.json();
                            allOrders = orders;
                            displayAdminOrders(orders);
                        } else {
                            console.error('Помилка завантаження всіх замовлень');
                        }
                    } catch (error) {
                        console.error('Помилка завантаження всіх замовлень:', error);
                    }
                }

                // Відображення всіх замовлень у панелі адміністрування
                function displayAdminOrders(orders) {
                    const adminOrdersContainer = document.getElementById('adminOrdersList');
                    adminOrdersContainer.innerHTML = '';

                    if (orders.length === 0) {
                        adminOrdersContainer.innerHTML = '<p>Замовлення не знайдені</p>';
                        return;
                    }

                    orders.forEach(order => {
                        const orderCard = document.createElement('div');
                        orderCard.className = 'order-card';

                        // Визначаємо статус замовлення
                        let statusText = '';
                        let statusClass = '';

                        switch (order.status) {
                            case 0:
                                statusText = 'Нове';
                                statusClass = 'available';
                                break;
                            case 1:
                                statusText = 'В обробці';
                                statusClass = 'available';
                                break;
                            case 2:
                                statusText = 'Завершено';
                                statusClass = 'available';
                                break;
                            case 3:
                                statusText = 'Скасовано';
                                statusClass = 'not-available';
                                break;
                            default:
                                statusText = 'Невідомий статус';
                                statusClass = '';
                        }

                        orderCard.innerHTML = `
<div class="book-title">Замовлення №${order.id}</div>
<div class="book-author">Користувач: ${order.userName || 'Невідомий користувач'}</div>
<div class="order-details">
            <p>Книга: ${order.bookTitle || 'Невідома книга'}</p>
            <p>Дата початку: ${formatDate(order.startDate)}</p>
            <p>Дата закінчення: ${formatDate(order.endDate)}</p>
            <p>Статус: <span class="${statusClass}">${statusText}</span></p>
</div>
                        `;

                        // Додаємо кнопки для керування замовленням
                        const buttonContainer = document.createElement('div');
                        buttonContainer.style.marginTop = '10px';

                        // Кнопка "В обробці" (для нових замовлень)
                        if (order.status === 0) {
                            const processButton = document.createElement('button');
                            processButton.textContent = 'В обробці';
                            processButton.className = 'green-button';
                            processButton.addEventListener('click', () => {
                                updateOrderStatus(order.id, 1);
                            });
                            buttonContainer.appendChild(processButton);
                        }

                        // Кнопка "Завершити" (для замовлень в обробці)
                        if (order.status === 1) {
                            const completeButton = document.createElement('button');
                            completeButton.textContent = 'Завершити';
                            completeButton.className = 'green-button';
                            completeButton.addEventListener('click', () => {
                                updateOrderStatus(order.id, 2);
                            });
                            buttonContainer.appendChild(completeButton);
                        }

                        // Кнопка "Скасувати" (для нових замовлень та замовлень в обробці)
                        if (order.status === 0 || order.status === 1) {
                            const cancelButton = document.createElement('button');
                            cancelButton.textContent = 'Скасувати';
                            cancelButton.className = 'red-button';
                            cancelButton.style.marginLeft = '10px';
                            cancelButton.addEventListener('click', () => {
                                if (confirm('Ви впевнені, що хочете скасувати це замовлення?')) {
                                    updateOrderStatus(order.id, 3);
                                }
                            });
                            buttonContainer.appendChild(cancelButton);
                        }

                        // Кнопка "Видалити" (тільки для адміністратора)
                        if (currentUser.roles.includes('Administrator')) {
                            const deleteButton = document.createElement('button');
                            deleteButton.textContent = 'Видалити';
                            deleteButton.className = 'red-button';
                            deleteButton.style.marginLeft = '10px';
                            deleteButton.addEventListener('click', () => {
                                if (confirm('Ви впевнені, що хочете видалити це замовлення?')) {
                                    deleteOrder(order.id);
                                }
                            });
                            buttonContainer.appendChild(deleteButton);
                        }

                        orderCard.appendChild(buttonContainer);
                        adminOrdersContainer.appendChild(orderCard);
                    });
                }

                // Оновлення статусу замовлення
                async function updateOrderStatus(orderId, newStatus) {
                    try {
                        // Спочатку отримаємо поточне замовлення
                        const response = await fetch(`/orders/GetSpecific/${orderId}`, {
                            method: 'GET',
                            credentials: 'include'
                        });

                        if (!response.ok) {
                            showStatusMessage('adminOrderStatus', 'Помилка отримання замовлення', false);
                            return;
                        }

                        const order = await response.json();

                        // Оновлюємо статус
                        order.Status = newStatus;

                        // Відправляємо оновлене замовлення
                        const updateResponse = await fetch(`/orders/Update?orderId=${orderId}`, {
                            method: 'PUT',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify(order),
                            credentials: 'include'
                        });

                        if (updateResponse.ok) {
                            showStatusMessage('adminOrderStatus', 'Статус замовлення успішно оновлено', true);

                            // Перезавантажуємо замовлення
                            loadAllOrders();
                        } else {
                            let errorMessage = 'Помилка оновлення статусу замовлення';
                            try {
                                const errorData = await updateResponse.json();
                                errorMessage = errorData.message || errorMessage;
                            } catch (e) {
                                // Ігноруємо помилку парсингу JSON
                            }
                            showStatusMessage('adminOrderStatus', errorMessage, false);
                        }
                    } catch (error) {
                        showStatusMessage('adminOrderStatus', `Помилка: ${error.message}`, false);
                    }
                }

                // Видалення замовлення
                async function deleteOrder(orderId) {
                    try {
                        const response = await fetch(`/orders/Delete?id=${orderId}`, {
                            method: 'DELETE',
                            credentials: 'include'
                        });

                        if (response.ok) {
                            showStatusMessage('adminOrderStatus', 'Замовлення успішно видалено', true);

                            // Перезавантажуємо замовлення
                            loadAllOrders();
                        } else {
                            let errorMessage = 'Помилка видалення замовлення';
                            try {
                                const errorData = await response.json();
                                errorMessage = errorData.message || errorMessage;
                            } catch (e) {
                                // Ігноруємо помилку парсингу JSON
                            }
                            showStatusMessage('adminOrderStatus', errorMessage, false);
                        }
                    } catch (error) {
                        showStatusMessage('adminOrderStatus', `Помилка: ${error.message}`, false);
                    }
                }

                // Допоміжні функції для отримання назв жанрів та типів книг
                function getGenreName(genreId) {
                    switch (genreId) {
                        case 0: return 'Фантастика';
                        case 1: return 'Детектив';
                        case 2: return 'Роман';
                        case 3: return 'Наукова література';
                        case 4: return 'Історія';
                        default: return 'Невідомий жанр';
                    }
                }

                function getTypeName(typeId) {
                    switch (typeId) {
                        case 0: return 'Паперова книга';
                        case 1: return 'Електронна книга';
                        case 2: return 'Аудіокнига';
                        default: return 'Невідомий тип';
                    }
                }

                // Ініціалізація - перевіряємо статус автентифікації при завантаженні сторінки
                document.addEventListener('DOMContentLoaded', () => {
                    checkAuthStatus();

                    // Встановлюємо поточну дату для полів дати
                    const today = new Date().toISOString().split('T')[0];
                    document.getElementById('startDate').min = today;
                    document.getElementById('endDate').min = today;

                    // Встановлюємо дату завершення за замовчуванням (через 14 днів)
                    const twoWeeksLater = new Date();
                    twoWeeksLater.setDate(twoWeeksLater.getDate() + 14);
                    document.getElementById('endDate').value = twoWeeksLater.toISOString().split('T')[0];

                    // Встановлюємо дату початку за замовчуванням (сьогодні)
                    document.getElementById('startDate').value = today;
                });
    </script>
</body>
</html>
<!DOCTYPE html>
